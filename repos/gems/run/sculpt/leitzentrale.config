<config>
	<input name="leitzentrale_enabled" rom="leitzentrale" node="leitzentrale">
		<attribute name="enabled" /> </input>
	<input name="reset_enabled" rom="reset" node="reset">
		<attribute name="enabled" /> </input>

	<output node="config">
		<inline>
			<parent-provides>
				<service name="ROM"/>
				<service name="PD"/>
				<service name="RM"/>
				<service name="CPU"/>
				<service name="LOG"/>
				<service name="Nitpicker"/>
				<service name="Timer"/>
				<service name="File_system"/>
			</parent-provides>

			<default-route> <any-service> <parent/> </any-service> </default-route>

			<default caps="100"/>
		</inline>
		<if>
			<has_value input="leitzentrale_enabled" value="yes" />
			<then>
				<inline>
					<start name="fader">
						<binary name="nit_fader"/>
						<resource name="RAM" quantum="19M"/>
						<provides> <service name="Nitpicker"/> </provides>
						<config alpha="190"/>
					</start>
				</inline>
			</then>
			<else>
				<inline>
					<start name="fader">
						<binary name="nit_fader"/>
						<resource name="RAM" quantum="19M"/>
						<provides> <service name="Nitpicker"/> </provides>
						<config alpha="0"/>
					</start>
				</inline>
			</else>
		</if>
		<inline>
			<start name="nit_fb">
				<resource name="RAM" quantum="8M"/>
				<provides> <service name="Framebuffer"/> <service name="Input"/> </provides>
				<config/>
				<route>
					<service name="Nitpicker"> <child name="fader"/> </service>
					<any-service> <parent/> </any-service>
				</route>
			</start>

			<start name="focus">
				<binary name="rom_filter"/>
				<resource name="RAM" quantum="1M"/>
				<provides> <service name="ROM"/> </provides>
				<config>
					<output node="focus">
						<attribute name="label" value="wm -> "/>
					</output>
				</config>
				<route> <any-service> <parent/> </any-service> </route>
			</start>

			<start name="nitpicker" caps="200">
				<resource name="RAM" quantum="2M"/>
				<provides> <service name="Nitpicker"/> </provides>
				<config focus="rom">
					<background color="#234567"/>
					<domain name="default" layer="1" content="client" label="no" hover="always" />
					<default-policy domain="default"/>
				</config>
				<route>
					<service name="Input">             <child name="nit_fb"/> </service>
					<service name="Framebuffer">       <child name="nit_fb"/> </service>
					<service name="ROM" label="focus"> <child name="focus"/>  </service>
					<any-service> <parent/> <any-child/> </any-service>
				</route>
			</start>

			<start name="report_rom">
				<resource name="RAM" quantum="4M"/>
				<provides>
					<service name="Report"/>
					<service name="ROM"/>
				</provides>
				<config>
					<policy label="layouter -> window_list"       report="wm -> window_list"/>
					<policy label="layouter -> focus_request"     report="wm -> focus_request"/>
					<policy label="decorator -> window_layout"    report="layouter -> window_layout"/>
					<policy label="wm -> resize_request"          report="layouter -> resize_request"/>
					<policy label="decorator -> pointer"          report="wm -> pointer"/>
					<policy label="layouter -> hover"             report="decorator -> hover"/>
					<policy label="layouter -> decorator_margins" report="decorator -> decorator_margins"/>
					<policy label="wm -> focus"                   report="layouter -> focus"/>
				</config>
			</start>

			<start name="wm" caps="150">
				<resource name="RAM" quantum="2M"/>
				<provides> <service name="Nitpicker"/> </provides>
				<config>
					<policy label_prefix="decorator" role="decorator"/>
					<policy label_prefix="layouter"  role="layouter"/>
				</config>
				<route>
					<service name="ROM" label="resize_request"> <child name="report_rom"/> </service>
					<service name="ROM" label="focus">          <child name="report_rom"/> </service>
					<service name="Report">                     <child name="report_rom"/> </service>
					<service name="Nitpicker"> <child name="nitpicker"/> </service>
					<any-service> <parent/> <any-child/> </any-service>
				</route>
			</start>

			<start name="layouter">
				<binary name="floating_window_layouter"/>
				<resource name="RAM" quantum="2M"/>
				<config/>
				<route>
					<service name="ROM" label="config"> <parent label="layouter.config"/>     </service>
					<service name="ROM" label="window_list">       <child name="report_rom"/> </service>
					<service name="ROM" label="focus_request">     <child name="report_rom"/> </service>
					<service name="ROM" label="hover">             <child name="report_rom"/> </service>
					<service name="ROM" label="decorator_margins"> <child name="report_rom"/> </service>
					<service name="Report">                        <child name="report_rom"/> </service>
					<service name="Nitpicker">                     <child name="wm"/>         </service>
					<any-service> <child name="wm"/> <parent/> <any-child/> </any-service>
				</route>
			</start>

			<start name="decorator" caps="200">
				<binary name="themed_decorator"/>
				<resource name="RAM" quantum="8M"/>
				<config>
					<libc/>
					<vfs> <tar name="plain_decorator_theme.tar"/> </vfs>
				</config>
				<route>
					<service name="ROM"    label="window_layout">     <child name="report_rom"/> </service>
					<service name="ROM"    label="pointer">           <child name="report_rom"/> </service>
					<service name="Report" label="decorator_margins"> <child name="report_rom"/> </service>
					<service name="Report" label="hover">             <child name="report_rom"/> </service>
					<service name="Nitpicker">                        <child name="wm"/>         </service>
					<any-service> <parent/> </any-service>
				</route>
			</start>

			<start name="noux_nit_fb">
				<binary name="nit_fb"/>
				<resource name="RAM" quantum="8M"/>
				<provides> <service name="Framebuffer"/> <service name="Input"/> </provides>
				<config initial_width="640" initial_height="480"/>
				<route>
					<any-service> <child name="wm"/> <parent/> </any-service>
				</route>
			</start>

		</inline>
		<if>
			<has_value input="reset_enabled" value="no" />
			<then>
				<inline>
					<start name="terminal">
						<binary name="terminal"/>
						<resource name="RAM" quantum="8M"/>
						<provides> <service name="Terminal"/> </provides>
						<route>
							<service name="ROM" label="config"> <parent label="fonts.config"/> </service>
							<any-service> <child name="noux_nit_fb"/> <parent/> </any-service>
						</route>
					</start>

					<start name="control_noux" caps="1000">
						<binary name="noux"/>
						<resource name="RAM" quantum="48M" />
						<config>
							<fstab>
								<tar name="coreutils-minimal.tar" />
								<tar name="vim-minimal.tar" />
								<tar name="bash-minimal.tar" />
								<dir name="dev"> <zero/> <null/> </dir>
								<dir name="config"> <fs label="config"/> </dir>
								<dir name="report"> <fs label="report"/> </dir>
								<dir name="tmp"> <ram /> </dir>
								<dir name="share"> <dir name="vim"> <rom name="vimrc"/> </dir> </dir>
								<rom name="README"/>
								<rom name="VERSION"/>
							</fstab>
							<start name="/bin/bash">
								<env name="TERM" value="screen" />
								<env name="PS1" value="genode:$PWD> " />
							</start>
						</config>
						<route>
							<service name="File_system" label="config">
								<parent label="config"/> </service>
							<service name="File_system" label="report">
								<parent label="report"/> </service>
							<any-service> <child name="terminal"/> <parent/> </any-service>
						</route>
					</start>
				</inline>
			</then>
		</if>
	</output>
</config>
